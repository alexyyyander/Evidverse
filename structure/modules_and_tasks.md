# Yivid 任务分解与优先级规划

基于 `plan/yivid_development_roadmap.md` 和 `plan/yivid_seedance_implementation.md` 的分析，我们将当前阶段（Phase 0: 技术验证）的开发任务分解为以下核心模块。

## 模块一：后端基础架构 (Backend Infrastructure)
**目标**: 搭建能够支撑视频生成和版本管理的基础服务。

| 任务ID | 任务名称 | 优先级 | 描述 |
|:---:|:---|:---:|:---|
| BE-01 | **搭建 FastAPI 项目框架** | **P0** | 初始化项目结构，配置异步支持，集成 Pydantic 模型。 |
| BE-02 | **数据库设计与集成** | **P0** | 设计 User, Project, Commit, Branch 表结构，配置 PostgreSQL 和 SQLAlchemy (Async)。 |
| BE-03 | **任务队列系统** | **P0** | 搭建 RabbitMQ/Redis 队列，用于处理耗时的视频生成任务。 |
| BE-04 | **对象存储接入** | **P1** | 集成 AWS S3 (或 MinIO) 用于存储生成的图片和视频资源。 |
| BE-05 | **API 文档与规范** | **P2** | 配置 Swagger/OpenAPI，定义统一的 API 响应格式。 |

## 模块二：AI 生成引擎 (AI Engine)
**目标**: 实现"剧本->角色->视频"的完整生成链路，并保证角色一致性。

| 任务ID | 任务名称 | 优先级 | 描述 |
|:---:|:---|:---:|:---|
| AI-01 | **Seedance API 集成** | **P0** | 封装 Seedance API 调用，实现 Image-to-Video 的基础生成。 |
| AI-02 | **角色一致性锚点 (Character Anchor)** | **P0** | 实现 LoRA 训练或 IP-Adapter 流程，确保多镜头下角色一致性。集成 CLIP 进行相似度验证。 |
| AI-03 | **Stable Diffusion 角色生成** | **P0** | 搭建或调用 SD 接口生成高质量、风格统一的角色参考图。 |
| AI-04 | **LLM 剧本生成模块** | **P1** | 集成 GPT-4/Claude，将简单 Prompt 转化为分镜脚本。 |
| AI-05 | **TTS 语音合成模块** | **P2** | 集成 ElevenLabs 或 EdgeTTS，为视频生成配音。 |

## 模块三：版本控制核心逻辑 (VCS Logic)
**目标**: 实现类似 Git 的视频版本管理逻辑。

| 任务ID | 任务名称 | 优先级 | 描述 |
|:---:|:---|:---:|:---|
| VCS-01 | **Commit 核心逻辑** | **P0** | 实现 Commit 的创建、哈希计算、父节点指向及元数据存储。 |
| VCS-02 | **Branch 分支管理** | **P0** | 实现分支创建、HEAD 指针移动、分支切换逻辑。 |
| VCS-03 | **Fork 机制** | **P1** | 实现项目的 Fork 逻辑，复制最新的 Commit 指针到新项目。 |
| VCS-04 | **Merge 策略 (基础版)** | **P2** | 实现简单的分支合并逻辑（如 Fast-forward）。 |

## 模块四：交互接口 (Interfaces)
**目标**: 提供开发者和早期用户可用的操作界面。

| 任务ID | 任务名称 | 优先级 | 描述 |
|:---:|:---|:---:|:---|
| CLI-01 | **CLI 工具开发 (yivid)** | **P1** | 开发命令行工具，支持 `init`, `generate`, `log`, `branch` 等操作。 |
| FE-01 | **React Native 基础脚手架** | **P2** | 初始化移动端项目，配置路由和基础 UI 组件库。 |
| FE-02 | **视频流与预览组件** | **P2** | 实现移动端的视频播放和分支可视化预览组件。 |

## 模块五：Web 可视化编辑器 (Web Visual Editor)
**目标**: 提供直观的 Web 界面，支持导入开源项目、可视化分支结构并进行在线编辑。

| 任务ID | 任务名称 | 优先级 | 描述 |
|:---:|:---|:---:|:---|
| FE-03 | **Web 项目导入器** | **P1** | 支持通过 URL/ID 导入公开的 Yivid 项目，解析元数据和版本树，实现“一键Fork别人项目”。 |
| FE-04 | **视频流可视化 (Git Graph)** | **P0** | 使用 React Flow/D3.js 实现提交历史的可视化图表，直观展示分支走向、合并记录和节点关系。 |
| FE-05 | **基于图的交互编辑** | **P1** | 支持在可视化图上点击节点进行实时预览、Fork 分支、Checkout 切换版本、Cherry-pick 挑选镜头。 |
| FE-06 | **Web 简易剪辑器** | **P1** | 实现基于时间轴的 Web 编辑器，支持多片段拼接、拖拽调整顺序、基础预览，对接后端合成 API。 |

## 优先级定义
- **P0 (Blocker)**: 核心路径，如果不完成，系统无法运行或无法验证核心价值。
- **P1 (Critical)**: 重要功能，MVP 必须包含，但可以稍后实现。
- **P2 (Major)**: 完善体验的功能，锦上添花。
- **P3 (Minor)**: 后续优化或非核心功能。

## 建议执行顺序
1. **BE-01, BE-02**: 先把地基打好。
2. **AI-01, AI-03**: 跑通最核心的视频生成。
3. **VCS-01, VCS-02**: 实现业务逻辑的核心差异化。
4. **AI-02**: 攻克技术难点（角色一致性）。
5. **CLI-01**: 提供测试工具。
